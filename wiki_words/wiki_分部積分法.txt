分部積分法


系列條目


微积分学





函数
导数
微分
积分




基本定理




函數極限
連續函數




均值定理
羅爾定理







基础概念



函数 · 數列 · 級數 · 极限
初等函数 · 無窮小量 · 收敛数列
收斂性 · 夹挤定理
连续 · 一致连续 · 间断点









一元微分



导数 · 高阶导数 · 介值定理 · 中值定理（罗尔定理 · 拉格朗日中值定理 · 柯西中值定理） · 泰勒公式 · 求导法则（乘法定则 · 除法定则 · 倒数定则 · 链式法则） · 洛必达法则 · 导数列表 · 导数的函数应用（单调性 · 极值 · 驻点 · 拐点 · 凹凸性 · 曲率）









一元积分



不定积分 · 定积分 · 积分的定义（黎曼积分 · 达布积分 · 勒贝格积分） · 积分表 · 求积分的技巧（吸納积分法 · 换元积分法 · 分部积分法 · 三角换元法 · 降次积分法 · 部分分式积分法） · 牛顿-莱布尼茨公式 · 广义积分 · 主值 · 柯西主值 · Β函数 · Γ函数 · 数值积分 · 牛顿-寇次公式 · 近似积分法（矩形法 · 梯形法 · 辛普森积分法）









多元微积分



多元函数 · 偏导数 · 隐函数 · 全微分 · 方向導數 · 梯度 · 泰勒公式 · 拉格朗日乘数 · 多元函数积分 · 多重积分 · 广义多重积分 · 曲线积分 · 曲面积分 · 格林公式 · 高斯公式 · 斯托克斯公式 · 散度 · 旋度









微分方程



常微分方程 · 分离变数法 · 积分因子 · 欧拉方法 · 柯西-欧拉方程 · 伯努利微分方程 · 克莱罗方程 · 全微分方程 · 线性微分方程 · 差分方程 · 拉普拉斯变换法 · 偏微分方程 · 拉普拉斯方程









相关数学家


牛顿 · 莱布尼兹 · 柯西 · 黎曼
拉格朗日 · 拉普拉斯 · 欧拉









查
论
编





分部積分法是種積分的技巧。它是由微分的乘法定則和微積分基本定理推導而來的。其基本思路是将不易求得结果的积分形式，转化为等价的但易于求出结果的积分形式。



目录


1 規則
2 例题
3 ILATE约法
4 参见



規則[编辑]
假設



h
(
x
)
 


{\displaystyle h(x)\ }

與



k
(
x
)
 


{\displaystyle k(x)\ }

是兩個連續可導函數。由乘積法則可知










d


(
h
k
)




d


x



=





d


h




d


x



k
+
h





d


k




d


x





{\displaystyle {\frac {{\rm {d}}(hk)}{{\rm {d}}x}}={\frac {{\rm {d}}h}{{\rm {d}}x}}k+h{\frac {{\rm {d}}k}{{\rm {d}}x}}}



對上述等式兩邊求不定積分，得









h
k



=
∫





d


h




d


x



k
+
h





d


k




d


x



 


d


x






=
∫
h
 


d


k
+
∫
k
 


d


h






{\displaystyle {\begin{aligned}hk&=\int {\frac {{\rm {d}}h}{{\rm {d}}x}}k+h{\frac {{\rm {d}}k}{{\rm {d}}x}}\ {\rm {d}}x\\&=\int h\ {\rm {d}}k+\int k\ {\rm {d}}h\\\end{aligned}}}



移项整理，得不定积分形式的分部积分方程





∫





d


h




d


x



k
 


d


x
=
h
k
−
∫
h





d


k




d


x



 


d


x


{\displaystyle \int {\frac {{\rm {d}}h}{{\rm {d}}x}}k\ {\rm {d}}x=hk-\int h{\frac {{\rm {d}}k}{{\rm {d}}x}}\ {\rm {d}}x}



由以上等式我们可以推导出分部积分法在区间



[
a
,
A
]
 


{\displaystyle [a,A]\ }

的定积分形式






∫

a


A







d


h




d


x



k
 


d


x
=


[


h
k



]



a


A


−

∫

a


A


h





d


k




d


x



 


d


x


{\displaystyle \int _{a}^{A}{\frac {{\rm {d}}h}{{\rm {d}}x}}k\ {\rm {d}}x={\big [}hk{\big ]}_{a}^{A}-\int _{a}^{A}h{\frac {{\rm {d}}k}{{\rm {d}}x}}\ {\rm {d}}x}



已经积出的部分





[


h
k



]



a


A




{\displaystyle {\big [}hk{\big ]}_{a}^{A}}

可以代入上下限



[
a
,
A
]
 


{\displaystyle [a,A]\ }

表示为以下等式，







[


h
k



]



a


A


=
h
(
A
)
k
(
A
)
−
h
(
a
)
k
(
a
)


{\displaystyle {\big [}hk{\big ]}_{a}^{A}=h(A)k(A)-h(a)k(a)}



而以上这条等式可以通过函数求导乘积法则，以及微积分基本定理通过以下方式倒推并得以验证









h
(
A
)
k
(
A
)
−
h
(
a
)
k
(
a
)



=

∫

a


A







d


(
h
k
)




d


x



 
d
x






=

∫

a


A







d


h




d


x



k
+
h





d


k




d


x



 
d
x






=

∫

a


A


k
 


d


h
+

∫

a


A


h
 


d


k






{\displaystyle {\begin{aligned}h(A)k(A)-h(a)k(a)&=\int _{a}^{A}{\frac {{\rm {d}}(hk)}{{\rm {d}}x}}\ dx\\&=\int _{a}^{A}{\frac {{\rm {d}}h}{{\rm {d}}x}}k+h{\frac {{\rm {d}}k}{{\rm {d}}x}}\ dx\\&=\int _{a}^{A}k\ {\rm {d}}h+\int _{a}^{A}h\ {\rm {d}}k\\\end{aligned}}}



在传统的微积分教材裡分部积分法通常写成不定积分形式：





∫
f
(
x
)

g
′

(
x
)

d
x
=
f
(
x
)
g
(
x
)
−
∫

f
′

(
x
)
g
(
x
)

d
x
,


{\displaystyle \int f(x)g'(x)\,dx=f(x)g(x)-\int f'(x)g(x)\,dx,}



如果更簡單些，令



u
=
f
(
x
)


{\displaystyle u=f(x)}

、



v
=
g
(
x
)


{\displaystyle v=g(x)}

，微分





d


u
=

f
′

(
x
)


d


x


{\displaystyle {\rm {d}}u=f'(x){\rm {d}}x}

和





d


v
=

g
′

(
x
)


d


x


{\displaystyle {\rm {d}}v=g'(x){\rm {d}}x}

,，就可以得到更常見到的形式：





∫
u

d
v
=
u
v
−
∫
v

d
u


{\displaystyle \int u\,dv=uv-\int v\,du}

。

注意，上面的原式中含有g的導數；在使用這個規則時必須先找到不定積分g，並且積分



∫
g

f
′



d


x


{\displaystyle \int gf'{\rm {d}}x}

必須是可積的。
在级数的离散分析中也可以用到类似的公式表达，称为分部求和。
另一可用的表達方式可以將原表達方式裡的因子僅寫成f和g，但缺點是引進了鑲套積分：





∫
f
g

d
x
=
f
∫
g

d
x
−
∫

(

f
′

∫
g

d
x
)


d
x


{\displaystyle \int fg\,dx=f\int g\,dx-\int \left(f'\int g\,dx\right)\,dx}

。

这个表达方式只有当f是连续可导而且g是连续是才有效。
在黎曼-斯蒂尔吉斯积分和勒贝格-斯蒂尔吉斯积分有更多分部积分的公式。
提示：部分積分下面這樣更複雜一點的積分運算裡也是有效的：





∫
u
v

d
w
=
u
v
w
−
∫
u
w

d
v
−
∫
v
w

d
u


{\displaystyle \int uv\,dw=uvw-\int uw\,dv-\int vw\,du}

。

例题[编辑]
用分部积分法求积分：





∫
x
cos
⁡
(
x
)

d
x


{\displaystyle \int x\cos(x)\,dx}



先设：

u = x,故du = dx,
dv = cos(x) dx,故v = sin(x).

代入原积分：









∫
x
cos
⁡
(
x
)

d
x



=
∫
u

d
v






=
u
v
−
∫
v

d
u






=
x
sin
⁡
(
x
)
−
∫
sin
⁡
(
x
)

d
x






=
x
sin
⁡
(
x
)
+
cos
⁡
(
x
)
+
C






{\displaystyle {\begin{aligned}\int x\cos(x)\,dx&=\int u\,dv\\&=uv-\int v\,du\\&=x\sin(x)-\int \sin(x)\,dx\\&=x\sin(x)+\cos(x)+C\end{aligned}}}



这里C是任意积分常数。
连续使用分部积分可以求解这类积分：





∫

x

3


sin
⁡
(
x
)

d
x


and


∫

x

2



e

x



d
x


{\displaystyle \int x^{3}\sin(x)\,dx\quad {\mbox{and}}\quad \int x^{2}e^{x}\,dx}



每次分部积分后x的幂减低1次。
下面这个例子需要用点技巧：





∫

e

x


cos
⁡
(
x
)

d
x


{\displaystyle \int e^{x}\cos(x)\,dx}



和其他例题不同的是分部积分之后得出的结果里含有要求解的积分式，在这时不必再按积分做下去。
此题要使用两次分部积分。先令：

u = cos(x);故du = −sin(x) dx
dv = ex dx;故v = ex

于是有：





∫

e

x


cos
⁡
(
x
)

d
x
=

e

x


cos
⁡
(
x
)
+
∫

e

x


sin
⁡
(
x
)

d
x


{\displaystyle \int e^{x}\cos(x)\,dx=e^{x}\cos(x)+\int e^{x}\sin(x)\,dx}



对余下的积分式再用分部积分，设：

u = sin(x); du = cos(x) dx
v = ex; dv = ex dx

得到：








∫

e

x


sin
⁡
(
x
)

d
x


{\displaystyle \int e^{x}\sin(x)\,dx}






=

e

x


sin
⁡
(
x
)
−
∫

e

x


cos
⁡
(
x
)

d
x


{\displaystyle =e^{x}\sin(x)-\int e^{x}\cos(x)\,dx}






把两次分部积分的结果合在一起：





∫

e

x


cos
⁡
(
x
)

d
x
=

e

x


cos
⁡
(
x
)
+

e

x


sin
⁡
(
x
)
−
∫

e

x


cos
⁡
(
x
)

d
x


{\displaystyle \int e^{x}\cos(x)\,dx=e^{x}\cos(x)+e^{x}\sin(x)-\int e^{x}\cos(x)\,dx}



注意，要求解的积分式同时出现在等式两边。我们只要把它移到等式一边就可以得到积分结果：





2
∫

e

x


cos
⁡
(
x
)

d
x
=

e

x


(
sin
⁡
(
x
)
+
cos
⁡
(
x
)
)
+
C


{\displaystyle 2\int e^{x}\cos(x)\,dx=e^{x}(\sin(x)+\cos(x))+C}








∫

e

x


cos
⁡
(
x
)

d
x
=




e

x


(
sin
⁡
(
x
)
+
cos
⁡
(
x
)
)

2


+
C


{\displaystyle \int e^{x}\cos(x)\,dx={e^{x}(\sin(x)+\cos(x)) \over 2}+C}



同样, C在这里是积分常数。
同样的技巧用在求解正割函数的立方的积分里。
另外两个很有用的分部积分范例是分部积分法用在函数本身和1的乘积。这里的前提是函数的导数是已知的，而且这个导数和x的乘积的积分已知。
第一个范例是∫ ln(x) dx.我们把它写成：





∫
ln
⁡
(
x
)
⋅
1

d
x


{\displaystyle \int \ln(x)\cdot 1\,dx}



设：

u = ln(x); du = 1/x dx
v = x; dv = 1·dx

于是：








∫
ln
⁡
(
x
)

d
x


{\displaystyle \int \ln(x)\,dx}






=
x
ln
⁡
(
x
)
−
∫


x
x



d
x


{\displaystyle =x\ln(x)-\int {\frac {x}{x}}\,dx}









=
x
ln
⁡
(
x
)
−
∫
1

d
x


{\displaystyle =x\ln(x)-\int 1\,dx}











∫
ln
⁡
(
x
)

d
x
=
x
ln
⁡
(
x
)
−

x

+

C



{\displaystyle \int \ln(x)\,dx=x\ln(x)-{x}+{C}}








∫
ln
⁡
(
x
)

d
x
=
x
(
ln
⁡
(
x
)
−
1
)
+
C


{\displaystyle \int \ln(x)\,dx=x(\ln(x)-1)+C}



同样, C是积分常数。
第二个范例是∫ arctan(x) dx,这里arctan(x)是反三角函数。成重写入下：





∫
arctan
⁡
(
x
)
⋅
1

d
x


{\displaystyle \int \arctan(x)\cdot 1\,dx}



令：

u = arctan(x); du = 1/(1+x2) dx
v = x; dv = 1·dx

代入后有：








∫
arctan
⁡
(
x
)

d
x


{\displaystyle \int \arctan(x)\,dx}






=
x
arctan
⁡
(
x
)
−
∫


x

1
+

x

2






d
x


{\displaystyle =x\arctan(x)-\int {\frac {x}{1+x^{2}}}\,dx}









=
x
arctan
⁡
(
x
)
−


1
2


ln
⁡

(
1
+

x

2


)

+
C


{\displaystyle =x\arctan(x)-{1 \over 2}\ln \left(1+x^{2}\right)+C}






其中用到换元积分法和自然对数积分。
ILATE约法[编辑]
用分部积分法时选择哪个函数为u哪个为dv很要紧，ILATE约法给出一个简单的选择u的方法：

I: 反三角函数：arctan x, arcsec x, etc.
L: 对数函数：ln x, 




log

2


⁡
(
x
)


{\displaystyle \log _{2}(x)}

, etc.
A: 代数函数：




x

2




{\displaystyle x^{2}}

, 



3

x

50




{\displaystyle 3x^{50}}

, etc.
T: 三角函数：sin x, tan x, etc.
E: 指数函数：




e

x




{\displaystyle e^{x}}

, 




13

x




{\displaystyle 13^{x}}

, etc.

u确定后，另一个函数自然是dv. ILATE这个口诀代表优先选择的顺序。.其中的道理是求列在后面的函数的积分比列在前面的更容易。
以下面这个积分作示范：





∫
x
cos
⁡
x

d
x
.



{\displaystyle \int x\cos x\,dx.\,}



根据ILATE约法, u = x和dv = cos x dx ,于是du = dx和v = sin x ,这个积分就变成





x
sin
⁡
x
−
∫
1
sin
⁡
x

d
x
,



{\displaystyle x\sin x-\int 1\sin x\,dx,\,}



等同于





x
sin
⁡
x
+
cos
⁡
x
+
C
.



{\displaystyle x\sin x+\cos x+C.\,}



总的来说在选u和dv时都是选得du比u 简单，dv容易被积。换过来，如果选cos x为u，x为dv,就要求这样的积分








x

2


2


cos
⁡
x
+
∫



x

2


2


sin
⁡
x

d
x




{\displaystyle {\frac {x^{2}}{2}}\cos x+\int {\frac {x^{2}}{2}}\sin x\,dx\,\,}



分部积分的结果还需要应用分部积分，陷入一个无限循环。
ILATE约法尽管很有用，也还是会有例外。所以有时可以用"LIATE"顺序替换。另外，在个别情况要将指数项拆开。例如，求积分





∫

x

3



e


x

2





d
x
,


{\displaystyle \int x^{3}e^{x^{2}}\,dx,}



要拆成





u
=

x

2


,

d
v
=
x

e


x

2





d
x


{\displaystyle u=x^{2},\quad dv=xe^{x^{2}}\,dx}

。

积分结果为





∫

x

3



e


x

2





d
x
=


1
2



e


x

2




(

x

2


−
1
)
+
C


{\displaystyle \int x^{3}e^{x^{2}}\,dx={\frac {1}{2}}e^{x^{2}}(x^{2}-1)+C}

。

参见[编辑]

换元积分法





分类：积分学
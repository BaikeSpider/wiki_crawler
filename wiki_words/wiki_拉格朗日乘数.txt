拉格朗日乘数





本条目需要精通或熟悉相关主题的编者参与及协助编辑。（2014年7月22日） 
請邀請適合的人士改善本条目。更多的細節與詳情請參见討論頁。 









系列條目


微积分学





函数
导数
微分
积分




基本定理




函數極限
連續函數




均值定理
羅爾定理







基础概念



函数 · 數列 · 級數 · 极限
初等函数 · 無窮小量 · 收敛数列
收斂性 · 夹挤定理
连续 · 一致连续 · 间断点









一元微分



导数 · 高阶导数 · 介值定理 · 中值定理（罗尔定理 · 拉格朗日中值定理 · 柯西中值定理） · 泰勒公式 · 求导法则（乘法定则 · 除法定则 · 倒数定则 · 链式法则） · 洛必达法则 · 导数列表 · 导数的函数应用（单调性 · 极值 · 驻点 · 拐点 · 凹凸性 · 曲率）









一元积分



不定积分 · 定积分 · 积分的定义（黎曼积分 · 达布积分 · 勒贝格积分） · 积分表 · 求积分的技巧（吸納积分法 · 换元积分法 · 分部积分法 · 三角换元法 · 降次积分法 · 部分分式积分法） · 牛顿-莱布尼茨公式 · 广义积分 · 主值 · 柯西主值 · Β函数 · Γ函数 · 数值积分 · 牛顿-寇次公式 · 近似积分法（矩形法 · 梯形法 · 辛普森积分法）









多元微积分



多元函数 · 偏导数 · 隐函数 · 全微分 · 方向導數 · 梯度 · 泰勒公式 · 拉格朗日乘数 · 多元函数积分 · 多重积分 · 广义多重积分 · 曲线积分 · 曲面积分 · 格林公式 · 高斯公式 · 斯托克斯公式 · 散度 · 旋度









微分方程



常微分方程 · 分离变数法 · 积分因子 · 欧拉方法 · 柯西-欧拉方程 · 伯努利微分方程 · 克莱罗方程 · 全微分方程 · 线性微分方程 · 差分方程 · 拉普拉斯变换法 · 偏微分方程 · 拉普拉斯方程









相关数学家


牛顿 · 莱布尼兹 · 柯西 · 黎曼
拉格朗日 · 拉普拉斯 · 欧拉









查
论
编









图1：绿线标出的是约束g(x,y) = c的点的轨迹。蓝线是f的等高线。箭头表示斜率，和等高线的法线平行。


在数学中的最优化问题中，拉格朗日乘数法（以数学家约瑟夫·拉格朗日命名）是一种寻找多元函数在其变量受到一个或多个条件的约束时的极值的方法。这种方法可以将一个有n个变量与k个约束条件的最优化问题转换为一个解有n + k个变量的方程组的解的问题。这种方法中引入了一个或一组新的未知数，即拉格朗日乘数，又称拉格朗日乘子，或拉氏乘子，它们是在转换后的方程，即约束方程中作为梯度（gradient）的线性组合中各个向量的系数。
比如，要求



f
(
x
,
y
)



{\displaystyle f(x,y)\,}

在



g
(
x
,
y
)
=
c



{\displaystyle g(x,y)=c\,}

时的最大值时，我们可以引入新变量拉格朗日乘数



λ


{\displaystyle \lambda }

，这时我们只需要下列拉格朗日函数的极值：







L


(
x
,
y
,
λ
)
=
f
(
x
,
y
)
+
λ
⋅


(


g
(
x
,
y
)
−
c


)




{\displaystyle {\mathcal {L}}(x,y,\lambda )=f(x,y)+\lambda \cdot {\Big (}g(x,y)-c{\Big )}}



更一般地，对含n个变量和k个约束的情况，有：







L



(

x

1


,
…
,

x

n


,

λ

1


,
…
,

λ

k


)

=
f

(

x

1


,
…
,

x

n


)

−

∑

i
=
1


k




λ

i



g

i



(

x

1


,
…
,

x

n


)


,


{\displaystyle {\mathcal {L}}\left(x_{1},\ldots ,x_{n},\lambda _{1},\ldots ,\lambda _{k}\right)=f\left(x_{1},\ldots ,x_{n}\right)-\sum \limits _{i=1}^{k}{\lambda _{i}g_{i}\left(x_{1},\ldots ,x_{n}\right)},}



拉格朗日乘数法所得的极点会包含原问题的所有极值点，但并不保证每个极值点都是原问题的极值点。拉格朗日乘数法的正确性的证明牵涉到偏微分，全微分或链法。



目录


1 介绍
2 证明
3 拉格朗日乘数的运用方法
4 例子

4.1 很简单的例子
4.2 另一个例子


5 经济学
6 参考
7 对外链接



介绍[编辑]
微积分中最常见的问题之一是求一个函数的极大极小值（极值）。但是很多时候找到极值函数的显式表达是很困难的，特别是当函数有先决条件或约束时。拉格朗日乘数则提供了一个非常便利方法来解决这类问题，而避开显式地引入约束和求解外部变量。
先看一个二维的例子：假设有函数：



f
(
x
,
y
)


{\displaystyle f(x,y)}

，要求其极值（最大值/最小值），且满足条件





g

(
x
,
y
)

=
c


{\displaystyle g\left(x,y\right)=c}



c为常数。對不同




d

n




{\displaystyle d_{n}}

的值，不难想像出





f

(
x
,
y
)

=

d

n




{\displaystyle f\left(x,y\right)=d_{n}}



的等高线。而方程



g


{\displaystyle g}

的可行集所构成的线正好是



g
(
x
,
y
)
=
c


{\displaystyle g(x,y)=c}

。想像我们沿着



g
=
c


{\displaystyle g=c}

的可行集走；因为大部分情况下



f


{\displaystyle f}

的等高线和



g


{\displaystyle g}

的可行集线不会重合，但在有解的情况下，这两条线会相交。想像此时我们移动



g
=
c


{\displaystyle g=c}

上的点，因为



f


{\displaystyle f}

是连续的方程，我们因此能走到



f

(
x
,
y
)

=

d

n




{\displaystyle f\left(x,y\right)=d_{n}}

更高或更低的等高线上，也就是说




d

n




{\displaystyle d_{n}}

可以变大或变小。只有当



g
=
c


{\displaystyle g=c}

和



f

(
x
,
y
)

=

d

n




{\displaystyle f\left(x,y\right)=d_{n}}

相切，也就是说，此时，我们正同时沿着



g
=
c


{\displaystyle g=c}

和



f

(
x
,
y
)

=

d

n




{\displaystyle f\left(x,y\right)=d_{n}}

走。这种情况下，会出现极值或鞍点。
气象图中就很常出现这样的例子，当温度和气压两列等高线同时出现的时候，切点就意味着约束极值的存在。
用向量的形式来表达的话，我们说相切的性质在此意味着



f


{\displaystyle f}

和



g


{\displaystyle g}

的切线在某点上平行，同时也意味着两者的梯度平行。此时引入一个未知标量



λ


{\displaystyle \lambda }

，并求解：





∇


[


f

(
x
,
y
)

+
λ

(
g

(
x
,
y
)

−
c
)



]


=
0


{\displaystyle \nabla {\Big [}f\left(x,y\right)+\lambda \left(g\left(x,y\right)-c\right){\Big ]}=0}



且λ ≠ 0.
一旦求出



λ


{\displaystyle \lambda }

的值，将其套入下式，易求在无约束条件下的极值和对应的极值点。





F

(
x
,
y
,
λ
)



{\displaystyle F\left(x,y,\lambda \right)}

 = 



f

(
x
,
y
)

+
λ

(
g

(
x
,
y
)

−
c
)



{\displaystyle f\left(x,y\right)+\lambda \left(g\left(x,y\right)-c\right)}



新方程



F
(
x
,
y
,
λ
)


{\displaystyle F(x,y,\lambda )}

在达到极值时与



f
(
x
,
y
)


{\displaystyle f(x,y)}

相等，因为



F
(
x
,
y
,
λ
)


{\displaystyle F(x,y,\lambda )}

达到极值时



g
(
x
,
y
)
−
c


{\displaystyle g(x,y)-c}

总等于零。
证明[编辑]
设函数



f
(
x
,
y
)


{\displaystyle f(x,y)}

在



A


{\displaystyle A}

点处有极值



κ


{\displaystyle \kappa }

，且在



A


{\displaystyle A}

点的邻域内连续。则在



A


{\displaystyle A}

点处有





f

(
x
,
y
)

=
κ


{\displaystyle f\left(x,y\right)=\kappa }



另有一常值函数





g

(
x
,
y
)

=
c


{\displaystyle g\left(x,y\right)=c}



二函数在



A


{\displaystyle A}

点处的全微分为






d

f
=



∂

f



∂

x





d

x
+



∂

f



∂

y





d

y
=
0


{\displaystyle \mathrm {d} f={\frac {\partial {f}}{\partial {x}}}\mathrm {d} x+{\frac {\partial {f}}{\partial {y}}}\mathrm {d} y=0}









d

g
=



∂

g



∂

x





d

x
+



∂

g



∂

y





d

y
=
0


{\displaystyle \mathrm {d} g={\frac {\partial {g}}{\partial {x}}}\mathrm {d} x+{\frac {\partial {g}}{\partial {y}}}\mathrm {d} y=0}



由于




d

x


{\displaystyle \mathrm {d} x}

和




d

y


{\displaystyle \mathrm {d} y}

是任取的无穷小量，故该线性方程组的系数成比例，有











∂

f



∂

x







∂

g



∂

x







=






∂

f



∂

y







∂

g



∂

y







=
−
λ


{\displaystyle {\dfrac {\dfrac {\partial {f}}{\partial {x}}}{\dfrac {\partial {g}}{\partial {x}}}}={\dfrac {\dfrac {\partial {f}}{\partial {y}}}{\dfrac {\partial {g}}{\partial {y}}}}=-\lambda }



即








∂

f



∂

x




+
λ
⋅



∂

g



∂

x




=
0


{\displaystyle {\frac {\partial {f}}{\partial {x}}}+\lambda \cdot {\frac {\partial {g}}{\partial {x}}}=0}











∂

f



∂

y




+
λ
⋅



∂

g



∂

y




=
0


{\displaystyle {\frac {\partial {f}}{\partial {y}}}+\lambda \cdot {\frac {\partial {g}}{\partial {y}}}=0}



将上二式分别乘以




d

x


{\displaystyle \mathrm {d} x}

和




d

y


{\displaystyle \mathrm {d} y}

，再相加并积分，得到一新函数







L


(
x
,
y
,
λ
)
=
f
(
x
,
y
)
+
λ
⋅
g
(
x
,
y
)


{\displaystyle {\mathcal {L}}(x,y,\lambda )=f(x,y)+\lambda \cdot g(x,y)}



那么，求原函数极值的问题就转化为求该函数极值的问题。
类似地，这种求极值的方法也可以推广到多维函数



f

(

x

1


,
…
,

x

n


)



{\displaystyle f\left(x_{1},\ldots ,x_{n}\right)}

。
拉格朗日乘数的运用方法[编辑]
如f定义为在Rn上的方程，约束为gk(x)= ck（或将约束左移得到gk(x) − ck = 0）。定义拉格朗日Λ为





Λ
(

x

,

λ

)
=
f
+

∑

k



λ

k


(

g

k


−

c

k


)


{\displaystyle \Lambda (\mathbf {x} ,{\boldsymbol {\lambda }})=f+\sum _{k}\lambda _{k}(g_{k}-c_{k})}

。

注意极值的条件和约束现在就都被记录到一个式子里了：





∇
Λ
=
0
⇔
∇
f
=
−

∑

k



λ

k


∇
 

g

k


,


{\displaystyle \nabla \Lambda =0\Leftrightarrow \nabla f=-\sum _{k}\lambda _{k}\nabla \ g_{k},}



和






∇


λ



Λ
=
0
⇔

g

k


=

c

k




{\displaystyle \nabla _{\mathbf {\lambda } }\Lambda =0\Leftrightarrow g_{k}=c_{k}}

。

拉格朗日乘数常被用作表达最大增长值。原因是从式子：





−



∂
Λ


∂


c

k






=

λ

k




{\displaystyle -{\frac {\partial \Lambda }{\partial {c_{k}}}}=\lambda _{k}}

。

中我们可以看出λk是当方程在被约束条件下，能够达到的最大增长率。拉格朗日力学就使用到这个原理。
拉格朗日乘数法在卡罗需－库恩－塔克条件被推广。
例子[编辑]
很简单的例子[编辑]
求此方程的最小值：





f
(
x
,
y
)
=

x

2


y


{\displaystyle f(x,y)=x^{2}y}



同时未知数满足






x

2


+

y

2


=
1


{\displaystyle x^{2}+y^{2}=1}



因为只有一个未知数的限制条件，我们只需要用一个乘数



λ


{\displaystyle \lambda }

.





g
(
x
,
y
)
=

x

2


+

y

2


−
1


{\displaystyle g(x,y)=x^{2}+y^{2}-1}








Φ
(
x
,
y
,
λ
)
=
f
(
x
,
y
)
+
λ
g
(
x
,
y
)
=

x

2


y
+
λ
(

x

2


+

y

2


−
1
)


{\displaystyle \Phi (x,y,\lambda )=f(x,y)+\lambda g(x,y)=x^{2}y+\lambda (x^{2}+y^{2}-1)}



将所有



Φ


{\displaystyle \Phi }

方程的偏微分设为零，得到一个方程组，最小值是以下方程组的解中的一个：





2
x
y
+
2
λ
x
=
0


{\displaystyle 2xy+2\lambda x=0}









x

2


+
2
λ
y
=
0


{\displaystyle x^{2}+2\lambda y=0}









x

2


+

y

2


−
1
=
0


{\displaystyle x^{2}+y^{2}-1=0}



另一个例子[编辑]
求此离散分布的最大熵：





f
(

p

1


,

p

2


,
…
,

p

n


)
=
−

∑

k
=
1


n



p

k



log

2


⁡

p

k




{\displaystyle f(p_{1},p_{2},\ldots ,p_{n})=-\sum _{k=1}^{n}p_{k}\log _{2}p_{k}}

。

所有概率的总和是1，因此我们得到的约束是g(p)= 1即





g
(

p

1


,

p

2


,
…
,

p

n


)
=

∑

k
=
1


n



p

k


=
1


{\displaystyle g(p_{1},p_{2},\ldots ,p_{n})=\sum _{k=1}^{n}p_{k}=1}

。

可以使用拉格朗日乘数找到最高熵（概率的函数）。对于所有的k从1到n，要求







∂

∂

p

k





(
f
+
λ
(
g
−
1
)
)
=
0
,


{\displaystyle {\frac {\partial }{\partial p_{k}}}(f+\lambda (g-1))=0,}



由此得到







∂

∂

p

k






(
−

∑

k
=
1


n



p

k



log

2


⁡

p

k


+
λ
(

∑

k
=
1


n



p

k


−
1
)
)

=
0


{\displaystyle {\frac {\partial }{\partial p_{k}}}\left(-\sum _{k=1}^{n}p_{k}\log _{2}p_{k}+\lambda (\sum _{k=1}^{n}p_{k}-1)\right)=0}

。

计算出这n个等式的微分，我们得到：





−

(


1

ln
⁡
2



+

log

2


⁡

p

k


)

+
λ
=
0


{\displaystyle -\left({\frac {1}{\ln 2}}+\log _{2}p_{k}\right)+\lambda =0}

。

这说明pi都相等（因为它们都只是λ的函数）。解出约束∑k pk = 1，得到






p

k


=


1
n




{\displaystyle p_{k}={\frac {1}{n}}}

。

因此，使用均匀分布可得到最大熵的值。
经济学[编辑]
约束最优化在经济学占有很重要的地位。例如一个消费者的选择问题可以被视为一个求效用方程在预算约束下的最大值问题。拉格朗日乘数在经济学中被解释为影子价格，设定在某种约束下，在这里即收入的边际效用。
拉格朗日乘数就是效用函数在最优解处对收入的偏导数，也就是在最优解处增加一个单位收入带来的效用增加，或者说在最优解处有效用衡量收入的价值，称之为收入的边际效用。
在企业生产问题中，拉格朗日乘数用来衡量要素投入变动所带来的收入变动，du/dm=λ,u表示效用函数或生产函数，m表示收入或要素投入。
在具体数学推导中还可以运用包络定理的内容。
参考[编辑]

卡罗需－库恩－塔克条件：拉格朗日乘数的推广。
拉格朗日方程式
哈密頓原理
作用量

对外链接[编辑]
参考拉格朗日原作或方法的命名：

Earliest known uses of some of the words of mathematics: L

更深入的介绍和互动applet：

Applet
Tutorial and applet
Conceptual introduction (概念介绍和对于拉格朗日乘数方法在变分法以及物理中的运用)
Lagrange Multipliers without Permanent Scarring (tutorial by Dan Klein)





分类：多变量微积分最优化数理经济学隐藏分类：自2014年7月需要专业人士关注的页面
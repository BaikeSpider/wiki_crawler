差分


本文介紹的是数学当中的一种函数或运算。關於电子系统设计与信号传输中的差分传输，請見「差分信号」。


差分，又名差分函數或差分運算，是数学中的一个概念。它将原函数 



 
f
(
x
)


{\displaystyle \ f(x)}

 映射到 



 
f
(
x
+
a
)
−
f
(
x
+
b
)


{\displaystyle \ f(x+a)-f(x+b)}

。差分運算，相應於微分運算，是微积分中重要的一个概念。


系列條目


微积分学





函数
导数
微分
积分




基本定理




函數極限
連續函數




均值定理
羅爾定理







基础概念



函数 · 數列 · 級數 · 极限
初等函数 · 無窮小量 · 收敛数列
收斂性 · 夹挤定理
连续 · 一致连续 · 间断点









一元微分



导数 · 高阶导数 · 介值定理 · 中值定理（罗尔定理 · 拉格朗日中值定理 · 柯西中值定理） · 泰勒公式 · 求导法则（乘法定则 · 除法定则 · 倒数定则 · 链式法则） · 洛必达法则 · 导数列表 · 导数的函数应用（单调性 · 极值 · 驻点 · 拐点 · 凹凸性 · 曲率）









一元积分



不定积分 · 定积分 · 积分的定义（黎曼积分 · 达布积分 · 勒贝格积分） · 积分表 · 求积分的技巧（吸納积分法 · 换元积分法 · 分部积分法 · 三角换元法 · 降次积分法 · 部分分式积分法） · 牛顿-莱布尼茨公式 · 广义积分 · 主值 · 柯西主值 · Β函数 · Γ函数 · 数值积分 · 牛顿-寇次公式 · 近似积分法（矩形法 · 梯形法 · 辛普森积分法）









多元微积分



多元函数 · 偏导数 · 隐函数 · 全微分 · 方向導數 · 梯度 · 泰勒公式 · 拉格朗日乘数 · 多元函数积分 · 多重积分 · 广义多重积分 · 曲线积分 · 曲面积分 · 格林公式 · 高斯公式 · 斯托克斯公式 · 散度 · 旋度









微分方程



常微分方程 · 分离变数法 · 积分因子 · 欧拉方法 · 柯西-欧拉方程 · 伯努利微分方程 · 克莱罗方程 · 全微分方程 · 线性微分方程 · 差分方程 · 拉普拉斯变换法 · 偏微分方程 · 拉普拉斯方程









相关数学家


牛顿 · 莱布尼兹 · 柯西 · 黎曼
拉格朗日 · 拉普拉斯 · 欧拉









查
论
编








目录


1 定义

1.1 前向差分
1.2 逆向差分


2 差分的阶
3 差分的性质
4 牛頓級數

4.1 單位步長情況
4.2 實例
4.3 一般情況


5 参考
6 参见
7 参考文献



定义[编辑]
差分分为前向差分和逆向差分。
前向差分[编辑]
函数的前向差分通常简称为函数的差分。对于函数



 
f
(
x
)


{\displaystyle \ f(x)}

，如果在等距节点：






x

k


=

x

0


+
k
h
,
(
k
=
0
,
1
,
.
.
.
,
n
)


{\displaystyle x_{k}=x_{0}+kh,(k=0,1,...,n)}






 
Δ
f
(

x

k


)
=
f
(

x

k
+
1


)
−
f
(

x

k


)


{\displaystyle \ \Delta f(x_{k})=f(x_{k+1})-f(x_{k})}



则称



 
Δ
f
(
x
)


{\displaystyle \ \Delta f(x)}

，函数在每个小区间上的增量




y

k
+
1


−

y

k




{\displaystyle y_{k+1}-y_{k}}

为



 
f
(
x
)


{\displaystyle \ f(x)}

一阶差分。[1]
在微积分学中的有限差分（finite differences），前向差分通常是微分在离散的函数中的等效运算。差分方程的解法也与微分方程的解法相似。当



 
f
(
x
)


{\displaystyle \ f(x)}

是多项式时，前向差分为Delta算子（称



Δ


{\displaystyle \Delta }

为差分算子[2]），一种线性算子。前向差分会将多项式阶数降低 1。
逆向差分[编辑]
对于函数



 
f
(

x

k


)


{\displaystyle \ f(x_{k})}

，如果：





 
∇
f
(

x

k


)
=
f
(

x

k


)
−
f
(

x

k
−
1


)
.



{\displaystyle \ \nabla f(x_{k})=f(x_{k})-f(x_{k-1}).\,}



则称



 
∇
f
(

x

k


)


{\displaystyle \ \nabla f(x_{k})}

为



 
f
(
x
)


{\displaystyle \ f(x)}

的一阶逆向差分。
差分的阶[编辑]
一阶差分的差分为二阶差分，二阶差分的差分为三阶差分，其余类推。记：




 

Δ

n


[
f
]
(
x
)


{\displaystyle \ \Delta ^{n}[f](x)}

为



 
f
(
x
)


{\displaystyle \ f(x)}

的



 
n


{\displaystyle \ n}

阶差分。
如果








 

Δ

n


[
f
]
(
x
)


{\displaystyle \ \Delta ^{n}[f](x)}






 
=
Δ
{

Δ

n
−
1


[
f
]
(
x
)
}


{\displaystyle \ =\Delta \{\Delta ^{n-1}[f](x)\}}









 
=

Δ

n
−
1


[
f
]
(
x
+
1
)
−

Δ

n
−
1


[
f
]
(
x
)


{\displaystyle \ =\Delta ^{n-1}[f](x+1)-\Delta ^{n-1}[f](x)}






根据数学归纳法，有





 

Δ

n


[
f
]
(
x
)
=

∑

i
=
0


n





(


n
i


)



(
−
1

)

n
−
i


f
(
x
+
i
)


{\displaystyle \ \Delta ^{n}[f](x)=\sum _{i=0}^{n}{n \choose i}(-1)^{n-i}f(x+i)}



其中，



 



(


n
i


)





{\displaystyle \ {n \choose i}}

为二项式系数。
特别的，有





 

Δ

2


[
f
]
(
x
)
=
f
(
x
+
2
)
−
2
f
(
x
+
1
)
+
f
(
x
)


{\displaystyle \ \Delta ^{2}[f](x)=f(x+2)-2f(x+1)+f(x)}



前向差分有时候也称作数列的二项式变换
差分的性质[编辑]
对比解析函数中的微分的属性，差分的性质有：

如果C为常数，则有








Δ
C
=
0


{\displaystyle \Delta C=0}






线性：如果 



 
a


{\displaystyle \ a}

 和 



 
b


{\displaystyle \ b}

 为常数，则有








Δ
(
a
f
+
b
g
)
=
a
Δ
f
+
b
Δ
g


{\displaystyle \Delta (af+bg)=a\Delta f+b\Delta g}






乘法定则：








Δ
(
f
g
)
=
f
Δ
g
+
g
Δ
f
+
Δ
f
Δ
g


{\displaystyle \Delta (fg)=f\Delta g+g\Delta f+\Delta f\Delta g}






∇
(
f
g
)
=
f
∇
g
+
g
∇
f
−
∇
f
∇
g


{\displaystyle \nabla (fg)=f\nabla g+g\nabla f-\nabla f\nabla g}






除法定则：








∇

(


f
g


)

=


1
g


det


[



∇
f


∇
g




f


g



]


det



[



g


∇
g




1


1



]



−
1




{\displaystyle \nabla \left({\frac {f}{g}}\right)={\frac {1}{g}}\det {\begin{bmatrix}\nabla f&\nabla g\\f&g\end{bmatrix}}\det {\begin{bmatrix}g&\nabla g\\1&1\end{bmatrix}}^{-1}}






Δ

(



f
g



)

=



1
g



det


[



Δ
f


Δ
g




f


g



]


det



[



g


Δ
g




−
1


1



]



−
1




{\displaystyle \Delta \left({\dfrac {f}{g}}\right)={\dfrac {1}{g}}\det {\begin{bmatrix}\Delta f&\Delta g\\f&g\end{bmatrix}}\det {\begin{bmatrix}g&\Delta g\\-1&1\end{bmatrix}}^{-1}}




或





∇

(


f
g


)

=



g
∇
f
−
f
∇
g


g
⋅
(
g
−
∇
g
)





{\displaystyle \nabla \left({\frac {f}{g}}\right)={\frac {g\nabla f-f\nabla g}{g\cdot (g-\nabla g)}}}






Δ

(


f
g


)

=



g
Δ
f
−
f
Δ
g


g
⋅
(
g
+
Δ
g
)





{\displaystyle \Delta \left({\frac {f}{g}}\right)={\frac {g\Delta f-f\Delta g}{g\cdot (g+\Delta g)}}}






级数：









∑

n
=
a


b


Δ
f
(
n
)
=
f
(
b
+
1
)
−
f
(
a
)


{\displaystyle \sum _{n=a}^{b}\Delta f(n)=f(b+1)-f(a)}







∑

n
=
a


b


∇
f
(
n
)
=
f
(
b
)
−
f
(
a
−
1
)


{\displaystyle \sum _{n=a}^{b}\nabla f(n)=f(b)-f(a-1)}





牛頓級數[编辑]
参见：均差




《自然哲學的數學原理》的第三編“宇宙體系”的引理五的图例。這裡在橫坐標上有6個點H,I,K,L,M,N，對應著6個值A,B,C,D,E,F，生成一個多項式函數對這6個點上有對應的6個值，計算任意點S對應的值R。牛頓給出了間距為單位值和任意值的兩種情況。


牛頓插值公式也叫做牛頓級數，由“牛頓前向差分方程”的項組成，得名於伊薩克·牛頓爵士，最早发表为他在1687年出版的《自然哲學的數學原理》中第三編“宇宙體系”的引理五[3]，此前詹姆斯·格雷果里於1670年和牛頓於1676年已經分別獨立得出這個成果。一般稱其為連續泰勒展開的離散對應。
單位步長情況[编辑]
當x值間隔為單位步長1時，有：









f
(
x
)



=
f
(
a
)
+



x
−
a

1



[


Δ

1


[
f
]
(
a
)
+



x
−
a
−
1

2



(


Δ

2


[
f
]
(
a
)
+
⋯

)


]







=
f
(
a
)
+

∑

k
=
1


n



Δ

k


[
f
]
(
a
)

∏

i
=
1


k





[
(
x
−
a
)
−
i
+
1
]

i








=

∑

k
=
0


n





(



x
−
a

k


)



 

Δ

k


[
f
]
(
a
)






{\displaystyle {\begin{aligned}f(x)&=f(a)+{\frac {x-a}{1}}\left[\Delta ^{1}[f](a)+{\frac {x-a-1}{2}}\left(\Delta ^{2}[f](a)+\cdots \right)\right]\\&=f(a)+\sum _{k=1}^{n}\Delta ^{k}[f](a)\prod _{i=1}^{k}{\frac {[(x-a)-i+1]}{i}}\\&=\sum _{k=0}^{n}{x-a \choose k}~\Delta ^{k}[f](a)\\\end{aligned}}}



這成立於任何多項式函數和大多數但非全部解析函數。這裡的表達式








(


x
k


)



=



(
x

)

k




k
!





(
x

)

k


=
x
(
x
−
1
)
(
x
−
2
)
⋯
(
x
−
k
+
1
)


{\displaystyle {x \choose k}={\frac {(x)_{k}}{k!}}\quad \quad (x)_{k}=x(x-1)(x-2)\cdots (x-k+1)}



是二項式係數，其中的(x)k是“下降階乘冪”，空乘積(x)0被定義為1。這裡的Δk[f](x)是“前向差分”的特定情況，即間距h=1。
實例[编辑]
為了展示牛頓的這個公式是如何使用的，舉例數列 1, 4, 9,16...的前幾項，可以找到一個多項式重新生成這些值，首先計算一個差分表，接著將對應於x0（標示了下劃線）的這些差分代換入公式，













x



Δ

0





Δ

1





Δ

2





Δ

3






1




1
_













3
_








2


4





2
_









5





0
_






3


9



2







7






4


16














f
(
x
)



=

Δ

0


+

Δ

1






(
x
−

x

0


)


1
!




+

Δ

2






(
x
−

x

0


)
(
x
−

x

0


−
1
)


2
!





(

x

0


=
1
)






=
1
+
3
⋅




x
−
1

1



+
2
⋅




(
x
−
1
)
(
x
−
2
)

2









=
1
+
3
(
x
−
1
)
+
(
x
−
1
)
(
x
−
2
)






=

x

2












{\displaystyle {\begin{matrix}{\begin{array}{|c||c|c|c|c|}\hline x&\Delta ^{0}&\Delta ^{1}&\Delta ^{2}&\Delta ^{3}\\\hline 1&{\underline {1}}&&&\\&&{\underline {3}}&&\\2&4&&{\underline {2}}&\\&&5&&{\underline {0}}\\3&9&&2&\\&&7&&\\4&16&&&\\\hline \end{array}}&\quad {\begin{aligned}f(x)&=\Delta ^{0}+\Delta ^{1}{\dfrac {(x-x_{0})}{1!}}+\Delta ^{2}{\dfrac {(x-x_{0})(x-x_{0}-1)}{2!}}\quad (x_{0}=1)\\&=1+3\cdot {\dfrac {x-1}{1}}+2\cdot {\dfrac {(x-1)(x-2)}{2}}\\&=1+3(x-1)+(x-1)(x-2)\\&=x^{2}\end{aligned}}\end{matrix}}}



一般情況[编辑]
對於x值間隔為非一致步長的情況，牛頓計算均差，在間隔一致但非單位量時，即上述前向差分的一般情況，插值公式為：









f
(
x
)



=
f
(
a
)
+



x
−
a

h



[


Δ

h


1


[
f
]
(
a
)
+



x
−
a
−
h


2
h




(


Δ

h


2


[
f
]
(
a
)
+
⋯

)


]







=
f
(
a
)
+

∑

k
=
1


n






Δ

h


k


[
f
]
(
a
)


k
!

h

k






∏

i
=
0


k
−
1


[
(
x
−
a
)
−
i
h
]






=
f
(
a
)
+

∑

k
=
1


n






Δ

h


k


[
f
]
(
a
)


k
!




∏

i
=
0


k
−
1



(




x
−
a

h


−
i

)

.






{\displaystyle {\begin{aligned}f(x)&=f(a)+{\frac {x-a}{h}}\left[\Delta _{h}^{1}[f](a)+{\frac {x-a-h}{2h}}\left(\Delta _{h}^{2}[f](a)+\cdots \right)\right]\\&=f(a)+\sum _{k=1}^{n}{\frac {\Delta _{h}^{k}[f](a)}{k!h^{k}}}\prod _{i=0}^{k-1}[(x-a)-ih]\\&=f(a)+\sum _{k=1}^{n}{\frac {\Delta _{h}^{k}[f](a)}{k!}}\prod _{i=0}^{k-1}\left({\frac {x-a}{h}}-i\right).\end{aligned}}}



在最終公式中hk被消去掉了，對於非一致步長的情況則不會出現階乘。
参考[编辑]


^ 科学出版社 《数值分析及科学计算》 薛毅（编） 第六章 第2节 Newton插值. P204.
^ 科学出版社 《数值分析及科学计算》 薛毅（编） 第六章 第2节 Newton插值. P205.
^ Newton, Isaac, (1687). Principia, Book III, Lemma V, Case 1


参见[编辑]

递归
遞迴關係式
拉格朗日多项式
吉尔布雷斯猜想
牛顿多项式
牛顿级数表
泰勒级数
时标微积分
分部求和法

参考文献[编辑]

Flajolet, Philippe; Sedgewick, Robert, Mellin transforms and asymptotics: Finite differences and Rice's integrals, Theoretical Computer Science, 1995, 144 (1–2): 101–124, doi:10.1016/0304-3975(94)00281-M [失效連結].





分类：微积分数学公式隐藏分类：带有失效链接的条目条目有永久失效的外部链接